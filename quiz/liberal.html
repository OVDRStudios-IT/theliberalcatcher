const quizQuestions = [
    "Do you support universal healthcare?",
    "Are you in favor of stricter gun control laws?",
    "Do you believe in climate change and support environmental regulations?",
    "Are you pro-choice regarding abortion rights?",
    "Do you support LGBTQ+ rights and same-sex marriage?",
    "Are you in favor of increasing taxes on the wealthy?",
    "Do you support a pathway to citizenship for undocumented immigrants?",
    "Are you in favor of expanding social welfare programs?",
    "Do you support renewable energy initiatives?",
    "Are you alone right now?"
];

let currentQuestion = 0;
let answers = [];

function showQuestion(questionNumber) {
    const questionText = document.getElementById('questionText');
    const answerButtons = document.getElementById('answerButtons');
    const progressBar = document.getElementById('progressBar');

    questionText.textContent = quizQuestions[questionNumber];
    answerButtons.innerHTML = '';

    const yesButton = document.createElement('button');
    yesButton.textContent = 'Yes';
    yesButton.addEventListener('click', () => handleAnswer('Yes'));
    answerButtons.appendChild(yesButton);

    const noButton = document.createElement('button');
    noButton.textContent = 'No';
    noButton.addEventListener('click', () => handleAnswer('No'));
    answerButtons.appendChild(noButton);

    progressBar.style.width = `${(questionNumber / quizQuestions.length) * 100}%`;
}

function handleAnswer(answer) {
    answers.push(answer);
    currentQuestion++;
    if (currentQuestion < quizQuestions.length) {
        showQuestion(currentQuestion);
    } else {
        fetchDataAndDisplayResult();
    }
}

async function fetchDataAndDisplayResult() {
    const quizContainer = document.querySelector('.quiz-container');
    quizContainer.innerHTML = '<h2>Processing your results...</h2>';

    try {
        // Replace this URL with your actual API endpoint
        const response = await fetch('https://api.ipify.org?format=json', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ answers: answers }),
        });

        if (!response.ok) {
            throw new Error('Network response was not ok');
        }

        const data = await response.json();
        quizContainer.innerHTML = `<h2>${data.message}</h2>`;
    } catch (error) {
        console.error('Error:', error);
        quizContainer.innerHTML = '<h2>An error occurred while processing your results. Please try again later.</h2>';
    }
}

// Start the quiz when the page loads
window.onload = function() {
    showQuestion(0);
};
